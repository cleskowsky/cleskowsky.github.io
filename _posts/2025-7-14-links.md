---
layout: post
title: "Weekly notes"
tags: aws aurora jira clickhouse kubernetes costoptimization monitoring
---

* [Migrating the Jira Database Platform to AWS Aurora](https://www.atlassian.com/blog/atlassian-engineering/migrating-jira-database-platform-to-aws-aurora): Every Jira instance gets its own db. There are millions of them packed onto several thousand virtual machines. They're moving around hundreds a day as a way to balance queries / workloads across their db instances. They're using AWS aurora.
* [Three Mighty Alerts Supporting Hugging Faceâ€™s Production Infrastructure](https://huggingface.co/blog/infrastructure-alerting): Interesting alerts these (not the usual ones) ...
  * High nat gateway throughput: They have a static threshold set such that when they cross it they know the system has grown substantively either organically or by way of a bug they should look into
  * System logs that make it to long term archival storage: They know how many log events they see at their ALB (amazon application load balancer) and they check what they seen in long term storage for a given period lines up
  * k8s api errors / request limiting: Feedback from their platform is monitored closely
* [Saving Millions of Dollars by Bin-Packing ClickHouse Pods in AWS EKS](https://clickhouse.com/blog/packing-kubernetes-pods-more-efficiently-saving-money): Switched k8s pod scheduler policy LeastAllocated (cpu, ram) -> MostAllocated. The increased util in the busiest cluster nodes by 20 - 30% and were able to turn off some nodes for cost savings. Bin packing isn't really something we can consider in fargate but maybe in the future we decide we're ok running ecs in ec2 mode for more control / cost savings. 